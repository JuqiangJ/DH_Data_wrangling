<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 5 Tidy your data | An Introduction to Data wrangling with R</title>
  <meta name="description" content="This is an introduction to data wrangling with R tutorial for DH summer school 2019 at Newcastle.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 5 Tidy your data | An Introduction to Data wrangling with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an introduction to data wrangling with R tutorial for DH summer school 2019 at Newcastle." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Tidy your data | An Introduction to Data wrangling with R" />
  
  <meta name="twitter:description" content="This is an introduction to data wrangling with R tutorial for DH summer school 2019 at Newcastle." />
  

<meta name="author" content="Juqiang Chen">


<meta name="date" content="2019-08-30">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="importing-your-data.html">
<link rel="next" href="tranform-your-data.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installing-r-and-r-studio"><i class="fa fa-check"></i><b>1.1</b> Installing R and R studio</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-libraries-in-r"><i class="fa fa-check"></i><b>1.2</b> Installing libraries in R</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#install-packages-and-library-packages"><i class="fa fa-check"></i><b>1.3</b> Install packages and library packages</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#programme"><i class="fa fa-check"></i><b>1.4</b> Programme</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Basic data structures in R</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#nominal-ordinal-intervalratio-variables"><i class="fa fa-check"></i><b>2.1</b> Nominal, ordinal, interval/ratio variables</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#d-data-structure-vectors"><i class="fa fa-check"></i><b>2.2</b> 1D data structure: vectors</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#creating-vectors"><i class="fa fa-check"></i><b>2.2.1</b> Creating vectors</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#creating-list-objects"><i class="fa fa-check"></i><b>2.2.2</b> creating list objects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#d-data-structures-matrice-and-data-frames"><i class="fa fa-check"></i><b>2.3</b> 2D data structures: matrice and data frames</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#what-if-i-want-to-change-column-names-or-add-variable-to-the-df"><i class="fa fa-check"></i><b>2.3.1</b> what if I want to change column names or add variable to the df?</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#subsetting-dataframes"><i class="fa fa-check"></i><b>2.3.2</b> Subsetting dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#summary"><i class="fa fa-check"></i><b>2.4</b> summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="what-is-data-wrangling.html"><a href="what-is-data-wrangling.html"><i class="fa fa-check"></i><b>3</b> What is data wrangling?</a><ul>
<li class="chapter" data-level="3.1" data-path="what-is-data-wrangling.html"><a href="what-is-data-wrangling.html#data-analysis-workflow"><i class="fa fa-check"></i><b>3.1</b> Data analysis workflow</a></li>
<li class="chapter" data-level="3.2" data-path="what-is-data-wrangling.html"><a href="what-is-data-wrangling.html#data-wrangling"><i class="fa fa-check"></i><b>3.2</b> Data wrangling</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="importing-your-data.html"><a href="importing-your-data.html"><i class="fa fa-check"></i><b>4</b> Importing your data</a><ul>
<li class="chapter" data-level="4.1" data-path="importing-your-data.html"><a href="importing-your-data.html#from-csvtxt"><i class="fa fa-check"></i><b>4.1</b> from CSV/TXT</a></li>
<li class="chapter" data-level="4.2" data-path="importing-your-data.html"><a href="importing-your-data.html#from-excel"><i class="fa fa-check"></i><b>4.2</b> from EXCEL</a></li>
<li class="chapter" data-level="4.3" data-path="importing-your-data.html"><a href="importing-your-data.html#batch-import"><i class="fa fa-check"></i><b>4.3</b> Batch import</a></li>
<li class="chapter" data-level="4.4" data-path="importing-your-data.html"><a href="importing-your-data.html#take-a-glimpse-of-the-dataframe"><i class="fa fa-check"></i><b>4.4</b> Take a glimpse of the dataframe</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tidy-your-data.html"><a href="tidy-your-data.html"><i class="fa fa-check"></i><b>5</b> Tidy your data</a><ul>
<li class="chapter" data-level="5.1" data-path="tidy-your-data.html"><a href="tidy-your-data.html#what-is-tidy-data"><i class="fa fa-check"></i><b>5.1</b> what is tidy data?</a></li>
<li class="chapter" data-level="5.2" data-path="tidy-your-data.html"><a href="tidy-your-data.html#tools-in-tidyr"><i class="fa fa-check"></i><b>5.2</b> Tools in tidyr</a><ul>
<li class="chapter" data-level="5.2.1" data-path="tidy-your-data.html"><a href="tidy-your-data.html#gather"><i class="fa fa-check"></i><b>5.2.1</b> gather()</a></li>
<li class="chapter" data-level="5.2.2" data-path="tidy-your-data.html"><a href="tidy-your-data.html#spread"><i class="fa fa-check"></i><b>5.2.2</b> spread()</a></li>
<li class="chapter" data-level="5.2.3" data-path="tidy-your-data.html"><a href="tidy-your-data.html#separate"><i class="fa fa-check"></i><b>5.2.3</b> separate()</a></li>
<li class="chapter" data-level="5.2.4" data-path="tidy-your-data.html"><a href="tidy-your-data.html#unite"><i class="fa fa-check"></i><b>5.2.4</b> unite()</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tranform-your-data.html"><a href="tranform-your-data.html"><i class="fa fa-check"></i><b>6</b> Tranform your data</a><ul>
<li class="chapter" data-level="6.1" data-path="tranform-your-data.html"><a href="tranform-your-data.html#selecting-variables-of-interest"><i class="fa fa-check"></i><b>6.1</b> Selecting variables of interest</a></li>
<li class="chapter" data-level="6.2" data-path="tranform-your-data.html"><a href="tranform-your-data.html#filtering-observations"><i class="fa fa-check"></i><b>6.2</b> Filtering observations</a></li>
<li class="chapter" data-level="6.3" data-path="tranform-your-data.html"><a href="tranform-your-data.html#changing-the-order-of-rows"><i class="fa fa-check"></i><b>6.3</b> changing the order of rows</a></li>
<li class="chapter" data-level="6.4" data-path="tranform-your-data.html"><a href="tranform-your-data.html#generating-new-variables"><i class="fa fa-check"></i><b>6.4</b> Generating new variables</a></li>
<li class="chapter" data-level="6.5" data-path="tranform-your-data.html"><a href="tranform-your-data.html#the-pipeline"><i class="fa fa-check"></i><b>6.5</b> the pipeline “%&gt;%”</a></li>
<li class="chapter" data-level="6.6" data-path="tranform-your-data.html"><a href="tranform-your-data.html#summarizing"><i class="fa fa-check"></i><b>6.6</b> Summarizing</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="build-your-own-function.html"><a href="build-your-own-function.html"><i class="fa fa-check"></i><b>7</b> Build your own function</a></li>
<li class="chapter" data-level="8" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>8</b> Resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Data wrangling with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidy-your-data" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Tidy your data</h1>
<div id="what-is-tidy-data" class="section level2">
<h2><span class="header-section-number">5.1</span> what is tidy data?</h2>
<p>Three rules:</p>
<ul>
<li><p>Each variable must have its own column.</p></li>
<li><p>Each observation must have its own row.</p></li>
<li><p>Each value must have its own cell.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(knitr)
<span class="co"># tidy data</span>
<span class="kw">kable</span>(table1, <span class="dt">caption =</span> <span class="st">&quot;a This is a tidy dataset!&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-12">Table 5.1: </span>a This is a tidy dataset!</caption>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">year</th>
<th align="right">cases</th>
<th align="right">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">1999</td>
<td align="right">745</td>
<td align="right">19987071</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="right">2000</td>
<td align="right">2666</td>
<td align="right">20595360</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="right">1999</td>
<td align="right">37737</td>
<td align="right">172006362</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">2000</td>
<td align="right">80488</td>
<td align="right">174504898</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">1999</td>
<td align="right">212258</td>
<td align="right">1272915272</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="right">2000</td>
<td align="right">213766</td>
<td align="right">1280428583</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(table2, <span class="dt">caption =</span> <span class="st">&quot;b case and population missing&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-12">Table 5.1: </span>b case and population missing</caption>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">year</th>
<th align="left">type</th>
<th align="right">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">1999</td>
<td align="left">cases</td>
<td align="right">745</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="right">1999</td>
<td align="left">population</td>
<td align="right">19987071</td>
</tr>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">2000</td>
<td align="left">cases</td>
<td align="right">2666</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="right">2000</td>
<td align="left">population</td>
<td align="right">20595360</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="right">1999</td>
<td align="left">cases</td>
<td align="right">37737</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">1999</td>
<td align="left">population</td>
<td align="right">172006362</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="right">2000</td>
<td align="left">cases</td>
<td align="right">80488</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">2000</td>
<td align="left">population</td>
<td align="right">174504898</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">1999</td>
<td align="left">cases</td>
<td align="right">212258</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="right">1999</td>
<td align="left">population</td>
<td align="right">1272915272</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">2000</td>
<td align="left">cases</td>
<td align="right">213766</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="right">2000</td>
<td align="left">population</td>
<td align="right">1280428583</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(table3, <span class="dt">caption =</span> <span class="st">&quot;c case and population merged&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-12">Table 5.1: </span>c case and population merged</caption>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">year</th>
<th align="left">rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">1999</td>
<td align="left">745/19987071</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="right">2000</td>
<td align="left">2666/20595360</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="right">1999</td>
<td align="left">37737/172006362</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">2000</td>
<td align="left">80488/174504898</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">1999</td>
<td align="left">212258/1272915272</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="right">2000</td>
<td align="left">213766/1280428583</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(table4a, <span class="dt">caption =</span> <span class="st">&quot;d year missing, cases&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-12">Table 5.1: </span>d year missing, cases</caption>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">1999</th>
<th align="right">2000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">745</td>
<td align="right">2666</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">37737</td>
<td align="right">80488</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">212258</td>
<td align="right">213766</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(table4b, <span class="dt">caption =</span> <span class="st">&quot;e year missing, population&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-12">Table 5.1: </span>e year missing, population</caption>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">1999</th>
<th align="right">2000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">19987071</td>
<td align="right">20595360</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">172006362</td>
<td align="right">174504898</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">1272915272</td>
<td align="right">1280428583</td>
</tr>
</tbody>
</table>
</div>
<div id="tools-in-tidyr" class="section level2">
<h2><span class="header-section-number">5.2</span> Tools in tidyr</h2>
<div id="gather" class="section level3">
<h3><span class="header-section-number">5.2.1</span> gather()</h3>
<p>For some datasets, some of the column names are not names of variables but <strong>values</strong> of a variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(table4a, <span class="dt">caption=</span> <span class="st">&quot;year missing, cases&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-13">Table 5.2: </span>year missing, cases</caption>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">1999</th>
<th align="right">2000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">745</td>
<td align="right">2666</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">37737</td>
<td align="right">80488</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">212258</td>
<td align="right">213766</td>
</tr>
<tr class="even">
<td align="left">We need to gat</td>
<td align="right">her years</td>
<td align="right">like 1999 and 2000 into one variable <strong>year</strong>.</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gather</span>(table4a, <span class="st">&#39;1999&#39;</span>,<span class="st">&#39;2000&#39;</span>,<span class="dt">key =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;cases&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country     year   cases
##   &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;
## 1 Afghanistan 1999     745
## 2 Brazil      1999   37737
## 3 China       1999  212258
## 4 Afghanistan 2000    2666
## 5 Brazil      2000   80488
## 6 China       2000  213766</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gather</span>(table4b, <span class="st">&#39;1999&#39;</span>,<span class="st">&#39;2000&#39;</span>,<span class="dt">key =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;population&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country     year  population
##   &lt;chr&gt;       &lt;chr&gt;      &lt;int&gt;
## 1 Afghanistan 1999    19987071
## 2 Brazil      1999   172006362
## 3 China       1999  1272915272
## 4 Afghanistan 2000    20595360
## 5 Brazil      2000   174504898
## 6 China       2000  1280428583</code></pre>
</div>
<div id="spread" class="section level3">
<h3><span class="header-section-number">5.2.2</span> spread()</h3>
<p>Sometime the observations are scattered across muiltiple rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(table2, <span class="dt">caption =</span> <span class="st">&quot;b case and population missing&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-15">Table 5.3: </span>b case and population missing</caption>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">year</th>
<th align="left">type</th>
<th align="right">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">1999</td>
<td align="left">cases</td>
<td align="right">745</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="right">1999</td>
<td align="left">population</td>
<td align="right">19987071</td>
</tr>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">2000</td>
<td align="left">cases</td>
<td align="right">2666</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="right">2000</td>
<td align="left">population</td>
<td align="right">20595360</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="right">1999</td>
<td align="left">cases</td>
<td align="right">37737</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">1999</td>
<td align="left">population</td>
<td align="right">172006362</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="right">2000</td>
<td align="left">cases</td>
<td align="right">80488</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">2000</td>
<td align="left">population</td>
<td align="right">174504898</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">1999</td>
<td align="left">cases</td>
<td align="right">212258</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="right">1999</td>
<td align="left">population</td>
<td align="right">1272915272</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">2000</td>
<td align="left">cases</td>
<td align="right">213766</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="right">2000</td>
<td align="left">population</td>
<td align="right">1280428583</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spread</span>(table2, <span class="dt">key =</span> type, <span class="dt">value =</span> count)</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<p>To sum up, gather() makes wide tables long while spread() make long tables wide. The key idea here is to think about the variable you want to explore and make sure that they are place in different columns.</p>
<hr />
</div>
<div id="separate" class="section level3">
<h3><span class="header-section-number">5.2.3</span> separate()</h3>
<p>In some cases, one column may contain a combination of two variables. We need to separate these two variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(table3, <span class="dt">caption =</span> <span class="st">&quot;c case and population merged&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-16">Table 5.4: </span>c case and population merged</caption>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">year</th>
<th align="left">rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">1999</td>
<td align="left">745/19987071</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="right">2000</td>
<td align="left">2666/20595360</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="right">1999</td>
<td align="left">37737/172006362</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">2000</td>
<td align="left">80488/174504898</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">1999</td>
<td align="left">212258/1272915272</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="right">2000</td>
<td align="left">213766/1280428583</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#separate by a delimiter</span>
<span class="kw">separate</span>(table3, rate, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year cases  population
##   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;     
## 1 Afghanistan  1999 745    19987071  
## 2 Afghanistan  2000 2666   20595360  
## 3 Brazil       1999 37737  172006362 
## 4 Brazil       2000 80488  174504898 
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#separate by the first two digits</span>

<span class="kw">separate</span>(table3, rate, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="dt">sep =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year cases population     
##   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1 Afghanistan  1999 74    5/19987071     
## 2 Afghanistan  2000 26    66/20595360    
## 3 Brazil       1999 37    737/172006362  
## 4 Brazil       2000 80    488/174504898  
## 5 China        1999 21    2258/1272915272
## 6 China        2000 21    3766/1280428583</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#separate by the last two digits</span>

<span class="kw">separate</span>(table3, rate, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="dt">sep =</span> <span class="op">-</span><span class="dv">2</span>)</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year cases           population
##   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;     
## 1 Afghanistan  1999 745/199870      71        
## 2 Afghanistan  2000 2666/205953     60        
## 3 Brazil       1999 37737/1720063   62        
## 4 Brazil       2000 80488/1745048   98        
## 5 China        1999 212258/12729152 72        
## 6 China        2000 213766/12804285 83</code></pre>
</div>
<div id="unite" class="section level3">
<h3><span class="header-section-number">5.2.4</span> unite()</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table_new =<span class="st"> </span><span class="kw">separate</span>(table3, year, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;year1&quot;</span>, <span class="st">&quot;year2&quot;</span>), <span class="dt">sep =</span> <span class="dv">2</span>)

<span class="kw">unite</span>(table_new, new, year1, year2)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country     new   rate             
##   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            
## 1 Afghanistan 19_99 745/19987071     
## 2 Afghanistan 20_00 2666/20595360    
## 3 Brazil      19_99 37737/172006362  
## 4 Brazil      20_00 80488/174504898  
## 5 China       19_99 212258/1272915272
## 6 China       20_00 213766/1280428583</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># by default there is an underscore between two parts.</span>
<span class="kw">unite</span>(table_new, new, year1, year2, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country     new   rate             
##   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            
## 1 Afghanistan 1999  745/19987071     
## 2 Afghanistan 2000  2666/20595360    
## 3 Brazil      1999  37737/172006362  
## 4 Brazil      2000  80488/174504898  
## 5 China       1999  212258/1272915272
## 6 China       2000  213766/1280428583</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="importing-your-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tranform-your-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-tidy.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
